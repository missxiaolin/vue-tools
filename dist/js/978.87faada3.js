"use strict";(self["webpackChunka"]=self["webpackChunka"]||[]).push([[978],{59978:function(e,t,l){l.r(t),l.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",[t("el-menu",{staticStyle:{background:"#6a60e3"},attrs:{mode:"horizontal"}},[t("div",{staticStyle:{width:"400px",float:"left",height:"70px",color:"#fff",background:"#5951b6","line-height":"70px"}},[t("h1",{staticStyle:{"text-align":"center"}},[e._v(e._s(e.templatesTitle))])]),t("el-form",{staticStyle:{float:"right",width:"1000px"},attrs:{inline:"inline"}},[t("el-button",{staticClass:"el-icon-plus btn_style",staticStyle:{width:"140px"},on:{click:function(t){return e.addTextHandle("textbox","add")}}},[e._v(" 添加文本框 ")]),t("el-button",{staticClass:"el-icon-plus btn_style",on:{click:e.imgDraw}},[t("input",{staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",id:"uploadfile"},on:{change:e.uploadFile}}),e._v(" 上传图片 ")]),t("el-button",{staticClass:"el-icon-edit btn_style",on:{click:e.initD}},[e._v(" 绘 制 ")]),t("el-button",{staticClass:"btn-delete btn_style el-icon-delete",on:{click:e.deleteText}},[e._v(" 删除控件 ")])],1)],1)],1),t("el-container",[t("el-aside",{attrs:{width:e.isCollapsed?"30px":"300px"}},[t("div",{staticClass:"text-edit"},[t("div",{staticClass:"title-setting",attrs:{tipTitle:e.isCollapsed?"展开设置":"收起设置"},on:{click:e.closeSetting}},[t("span",{staticClass:"text-setting"},[e._v(e._s(e.title))]),t("i",{class:e.isCollapsed?"el-icon-s-unfold":"el-icon-close"})]),t("el-form",{ref:"form"},[t("el-form-item",{attrs:{label:"文本内容："}},[t("div",{staticStyle:{width:"100%"},attrs:{id:"textBox"}},[t("el-input",{ref:"in",attrs:{type:"textarea",id:"in"},on:{input:e.changeText,focus:e.changeText},model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}})],1)]),t("el-form-item",{attrs:{label:"字体：","label-width":"82px"}},[t("el-select",{attrs:{placeholder:"请选择字体"},on:{change:e.changeFontFamily},model:{value:e.fontFamilies.value,callback:function(t){e.$set(e.fontFamilies,"value",t)},expression:"fontFamilies.value"}},e._l(e.fontFamilies,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"字体颜色："}},[t("el-select",{attrs:{placeholder:"请选择字体颜色"},on:{change:e.changeFontColor},model:{value:e.fontColor.value,callback:function(t){e.$set(e.fontColor,"value",t)},expression:"fontColor.value"}},e._l(e.fontColor,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"字体粗细："}},[t("el-select",{attrs:{placeholder:"请选择字体粗细"},on:{change:e.changefontWeight},model:{value:e.fontWeight.value,callback:function(t){e.$set(e.fontWeight,"value",t)},expression:"fontWeight.value"}},e._l(e.fontWeight,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"字体风格："}},[t("el-select",{attrs:{placeholder:"请选择字体风格"},on:{change:e.changeFontStyle},model:{value:e.fontStyle.value,callback:function(t){e.$set(e.fontStyle,"value",t)},expression:"fontStyle.value"}},e._l(e.fontStyle,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"字体大小："}},[t("el-select",{attrs:{placeholder:"选择字体大小"},on:{change:e.changeFontSize},model:{value:e.fontSizes.value,callback:function(t){e.$set(e.fontSizes,"value",t)},expression:"fontSizes.value"}},e._l(e.fontSizes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"对齐方式："}},[t("el-select",{attrs:{placeholder:"选择对齐方式"},on:{change:e.changeTextAlign},model:{value:e.textAlign.value,callback:function(t){e.$set(e.textAlign,"value",t)},expression:"textAlign.value"}},e._l(e.textAlign,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"背景颜色："}},[t("el-color-picker",{staticClass:"color-picker",attrs:{circle:"",size:"small","show-alpha":"",predefine:e.predefineColors,"color-format":"hex"},on:{change:e.changeBgColor},model:{value:e.bgcolor,callback:function(t){e.bgcolor=t},expression:"bgcolor"}})],1),t("el-form-item")],1)],1)]),t("el-main",{staticStyle:{height:"1040px"}},[t("div",{staticClass:"content-show"},[t("div",{staticClass:"canvas"},[t("canvas",{ref:"canvas",attrs:{id:"editorCanvas"}})])]),t("el-form",{staticClass:"handleSave"},[t("el-button",{staticClass:"btn-save",attrs:{type:"primary"},on:{click:e.downLoadImage1}},[e._v("预览图片")]),t("el-button",{staticClass:"btn-download",attrs:{type:"primary"},on:{click:e.downLoad}},[e._v("下载图片")]),t("el-form-item",{staticClass:"btn-zoom",staticStyle:{margin:"10px 0px"},attrs:{inline:"inline"}},[t("i",{staticClass:"el-icon-caret-left",on:{click:function(t){return e.zoomIt(.8)}}}),t("span",[e._v(" "+e._s(e.zoomCounter)+" % ")]),t("i",{staticClass:"el-icon-caret-right",on:{click:function(t){return e.zoomIt(1.2)}}})]),t("el-button",{staticClass:"btn-reset",attrs:{type:"danger"},on:{click:e.resetCanvas}},[e._v("重 置")])],1)],1),t("el-aside",{attrs:{width:e.isCollapsed?"30px":"375px"}},[t("div",{staticClass:"title-setting",attrs:{tipTitle:e.isCollapsed?"展开设置":"收起设置"},on:{click:e.closeSetting}},[t("span",{staticClass:"text-setting"},[e._v(e._s(e.showTitle))]),t("i",{class:e.isCollapsed?"el-icon-s-unfold":"el-icon-close"})]),t("img",{attrs:{src:e.imageBase64,alt:""}})])],1)],1)},o=[];const i=[{label:"宋体",value:"'sans-serif, cursive"},{label:"黑体",value:"'SimHei', cursive"},{label:"微软雅黑",value:"'Microsoft Yahei', cursive"},{label:"微软正黑体",value:"'Microsoft JhengHei', cursive"},{label:"楷体",value:"'KaiTi', cursive"},{label:"仿宋",value:"'FangSong', cursive"},{label:"苹方",value:"'PingFang SC', cursive"},{label:"华文黑体",value:"'STHeiti', cursive"},{label:"隶书",value:"'LiSu', cursive"},{label:"思源黑体",value:"'Source Han Sans CN', cursive"},{label:"Bebas Neue",value:"'Bebas Neue', cursive"},{label:"Caveat",value:"'Caveat', cursive"},{label:"Courgette",value:"'Courgette', cursive"},{label:"Dancing Script",value:"'Dancing Script', cursive"},{label:"Indie Flower",value:"'Indie Flower', cursive"},{label:"Kiwi Maru",value:"'Kiwi Maru', serif"},{label:"Lato",value:"'Lato', sans-serif"},{label:"Lexend",value:"'Lexend', sans-serif"},{label:"Lobster",value:"'Lobster', cursive"},{label:"Londrina Solid",value:"'Londrina Solid', cursive"},{label:"Montserrat",value:"'Montserrat', sans-serif"},{label:"New Tegomin",value:"'New Tegomin', serif"},{label:"Nunito",value:"'Nunito', sans-serif"},{label:"Open Sans",value:"'Open Sans', sans-serif"},{label:"Pacifico",value:"'Pacifico', cursive"},{label:"Permanent Marker",value:"'Permanent Marker', cursive"},{label:"Roboto",value:"'Roboto', sans-serif"},{label:"Shadows Into Light",value:"'Shadows Into Light', cursive"},{label:"Train One",value:"'Train One', cursive"},{label:"Yatra One",value:"'Yatra One', cursive"}],s=[{label:"9",value:9},{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"24",value:24},{label:"28",value:28},{label:"32",value:32},{label:"36",value:36},{label:"40",value:40},{label:"42",value:42},{label:"50",value:50},{label:"60",value:64},{label:"72",value:72},{label:"82",value:82},{label:"90",value:90},{label:"96",value:96}],n=[{value:"normal",label:"正常"},{value:"italic",label:"斜体"}],r=[{label:"黑色",value:"block"},{label:"白色",value:"white"},{label:"红色",value:"red"},{label:"绿色",value:"green"},{label:"蓝色",value:"blue"},{label:"紫色",value:"purple"}],c=[{value:"normal",label:"正常"},{value:"bold",label:"粗体"},{value:"lighter",label:"细体"},{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"},{value:"500",label:"500"},{value:"600",label:"600"},{value:"700",label:"700"},{value:"800",label:"800"},{value:"900",label:"900"}],u=[{label:"黑色",value:"block"},{label:"白色",value:"white"},{label:"红色",value:"red"},{label:"绿色",value:"green"},{label:"蓝色",value:"blue"},{label:"紫色",value:"purple"}],d=[{label:"居中",value:"center"},{label:"两端对齐",value:"justify"}];var v=l(69662);let b="";v.fabric.Object.prototype.set({cornerStrokeColor:"#66b0ef",cornerColor:"#60abec",cornerStyle:"rectangele",cornerSize:8,borderScaleFactor:2,transparentCorners:!1,borderColor:"#61abe8"});var f={name:"editor",data(){return{isHide:!0,checkAll:!1,isChecked:!1,isIndeterminate:!0,fontFamilies:i,fontSizes:s,fontColor:r,fontStyle:n,fontWeight:c,textAlign:d,backgroundColor:u,predefineColors:["#ffffff","#FF0000","#000000","#FFF800","#00FF0A","#FD00FF","#0095FF"],checked:!0,templateImgs:[],zoomCounter:100,tipTitle:"",imageBase64:"",isCollapsed:!1,backColor:"#eec5c5",backGroundStatus:!1,bgcolor:"#ff0000",itemWidth:"230px",done:!1,textStyleData:{type:"editText",text:"双击编辑文字",top:50,left:50,width:100,opacity:1,stroke:"#ffffff",strokeWidth:0,textAlign:"left",lineHeight:1,charSpacing:1,fontFamily:"hyzktjjkt",fontSize:40,fontWeight:"normal",fontStyle:"normal",fill:"#000000",textBackgroundColor:"rgba(0,0,0,0)",selectable:!0},isOpen:!1,isMove:!1,src:"",msg:"",canvas:null,templatesTitle:"海报生成",title:"文本设置",showTitle:"100% 预览",templateData:{},mouseFrom:{},mouseTo:{},moveCount:1}},mounted(){this.initeditorCanvas()},methods:{downLoadImage1(){this.done=!0;let e=b.toDataURL({formart:"png",multiplier:1});this.imageBase64=e,this.done=!1},saveTemplates(){console.log("你点击了模板保存");b.toDataURL({formart:"jpg",multiplier:1})},addTemplates(){console.log("添加模板")},initD(){const e=b.getActiveObject();b.on("mouse:down",(t=>{console.log("ceshi",t),e||(this.mouseFrom.x=t.e.clientX-b._offset.left,this.mouseFrom.y=t.e.clientY-b._offset.top)})),b.on("mouse:move",(t=>{e||(this.mouseTo.x=t.e.clientX-b._offset.left,this.mouseTo.y=t.e.clientY-b._offset.top,this.drawRect())})),b.on("mouse:up",(t=>{e||(this.mouseFrom.x=t.e.clientX-b._offset.left,this.mouseFrom.y=t.e.clientY-b._offset.top,this.doDrawing=!1,this.canvasObject=null,this.mouseFrom={},this.mouseTo={})})),b.on("selection:created",(e=>{e&&(this.doDrawing=!1)}))},getTransformedPosX(e){let t=Number(b.getZoom());return(e-b.viewportTransform[4])/t},getTransformedPosY(e){let t=Number(b.getZoom());return(e-b.viewportTransform[5])/t},drawRect(){let e=this.getTransformedPosX(this.mouseFrom.x),t=this.getTransformedPosY(this.mouseFrom.y),l=this.mouseTo.x-this.mouseFrom.x,a=this.mouseTo.y-this.mouseFrom.y;const o=new v.fabric.Rect({left:e,top:t,width:l,height:a,fill:"#d70202",strokeWidth:2});b.add(o)},initeditorCanvas(){b=new v.fabric.Canvas("editorCanvas",{devicePixelRatio:!0,width:"375",height:"667",originX:"center",originY:"center",backgroundColor:"#ffffff",transparentCorners:!1}),b.preserveObjectStacking=!0},closeSetting(){this.isCollapsed=!this.isCollapsed},imgDraw(){document.getElementById("uploadfile").click()},uploadFile(e){b.isDrawingMode=!1;let t=e.target.files[0],l=new FileReader;l.onload=e=>{e.target.result;v.fabric.Image.fromURL("https://cdn.enmonster.com/programImg/usercenter/user_img_default_bg.png",(e=>{b.add(e).renderAll()}))},l.readAsDataURL(t),e.target.value=""},downLoad(){this.done=!0;const e=b.toDataURL({width:b.width,height:b.height,left:0,top:0,format:"png"}),t=document.createElement("a");t.download="图片.png",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)},resetCanvas(){let e=b.getObjects();e.length>0&&b.remove(...e),b.setBackgroundColor("#fff")},zoomIt(e){let t=this.zoomCounter,l=b.width,a=b.height;if(e<1&&t>0){this.zoomCounter-=20,b.setWidth(l*e),b.setHeight(a*e);const t=b.getObjects();for(let l in t){let a=t[l].scaleX,o=t[l].scaleY,i=t[l].left,s=t[l].top,n=a*e,r=o*e,c=i*e,u=s*e;t[l].scaleX=n,t[l].scaleY=r,t[l].left=c,t[l].top=u,t[l].setCoords();let d=new v.fabric.Point(b.width/2,b.height/2);b.zoomToPoint(d,e),b.renderAll(),b.calcOffset()}}if(e>1&&t<100){this.zoomCounter+=20,b.setWidth(l*e),b.setHeight(a*e);const t=b.getObjects();for(let l in t){let a=t[l].scaleX,o=t[l].scaleY,i=t[l].left,s=t[l].top,n=a*e,r=o*e,c=i*e,u=s*e;t[l].scaleX=n,t[l].scaleY=r,t[l].left=c,t[l].top=u,t[l].setCoords()}let o=new v.fabric.Point(b.width/2,b.height/2);b.zoomToPoint(o,e),b.renderAll(),b.calcOffset()}},deleteText(){const e=b.getActiveObject();e&&b.remove(e),b.renderAll()},changeFontSize(e){let t=e;const l=b.getActiveObject();l&&(l.set({fontSize:t}),b.renderAll()),this.templateData.fontSize=t},changeBgColor(e){let t=e;const l=b;l&&(l.set({backgroundColor:t}),b.renderAll(),console.log(l.getObjects())),this.templateData.bgColor=t},changeFontColor(e){let t=e;const l=b.getActiveObject();l&&(l.set({fill:t}),b.renderAll()),this.templateData.textColor=t},changeTextAlign(e){let t=e;const l=b.getActiveObject();l&&(l.set("textAlign",t),l.centerH(),b.renderAll()),this.templateData.horizontalAlign=t},changefontWeight(e){let t=e;const l=b.getActiveObject();l&&(l.set("fontWeight",t),b.renderAll()),this.templateData.fontWeight=t},changeFontStyle(e){let t=e;const l=b.getActiveObject();l&&(l.set("fontStyle",t),b.renderAll()),this.templateData.fontStyle=t},changeFontFamily(e){let t=e;const l=b.getActiveObject();l&&(l.set("fontFamily",t),b.renderAll()),this.templateData.fontFamily=t},chooseTemplateSize(e){let t=e;console.log(t);let l=t.width,a=t.height;b.setHeight(a),b.setWidth(l),b.renderAll(),this.templateData.screenSize=t,this.templateData.screenHeight=a,this.templateData.screenWidth=l},changeText(){const e=b.getActiveObject();let t=this.msg;null!=t&&e&&(e.set("text",t),b.renderAll()),this.templateData.text=t},addTextHandle(e,t){switch(e){case"textbox":this.addTextObjectHandle(t);break;case"image":this.addImageObjectHandle(t);break}},addTextObjectHandle(e){let t,l;"add"==e&&(l=this.textStyleData,t=new v.fabric.Textbox(l.text||"",l),b.add(t).setActiveObject(t))},downLoadImage(){let e=b.toDataURL({formart:"png",multiplier:1});this.imageBase64=e,this.done=!1}},components:{},created(){}},h=f,m=l(43736),g=(0,m.Z)(h,a,o,!1,null,null,null),p=g.exports}}]);
//# sourceMappingURL=978.87faada3.js.map